import{j as e}from"./ui-DtQK8oIH.js";import{r as c}from"./vendor-DTE74Mn0.js";import{B as b,s as n}from"./supabase-BUPhfWfK.js";import{I as u}from"./input-B0jt3_8k.js";import{N as y}from"./Navbar-Dq13oUst.js";import{u as l}from"./index-B7tNQkvb.js";import{A as N}from"./arrow-up-right-D76Fi3uM.js";import"./supabase-BBSrB3Yz.js";import"./check-CM7pYQ67.js";const T=()=>{const[f,h]=c.useState(void 0),[m,x]=c.useState(null);c.useEffect(()=>{(async()=>{try{const{data:{user:r},error:t}=await n.auth.getUser();if(t){console.error(t);return}const{data:s,error:o}=await n.from("users").select("*").eq("user_id",r==null?void 0:r.id).single();if(o){console.error(o);return}h(s==null?void 0:s.name),x(r)}catch(r){console.error(r)}})()},[]);const p=async()=>{let a,r=!1;for(;!r;){a=Math.floor(1e5+Math.random()*9e5).toString();const{data:t}=await n.from("teams").select("team_id").eq("team_id",a);(!t||t.length===0)&&(r=!0)}return a},g=async a=>{a.preventDefault();const r=new FormData(a.target),t=Object.fromEntries(r.entries()),s=await p();console.log("This is the team id: ",s);const{data:o,error:i}=await n.from("teams").select("*").eq("name",t.name);if(i){console.error(i),l("Whoops!",{description:"Error creating team. Please try again."});return}if(o&&o.length>0){l("Whoops!",{description:"A Team already exists with that name. Please try another name."});return}const{error:d}=await n.rpc("register_team_and_user",{team_name:t.name,leader_email:m.email,leader_user_id:m.id,contact_number:t.contactNumber,user_email_param:m.email,new_team_id:s,problem_statement:null,domain:null});if(d){console.error(d),l("Whoops!",{description:"Error creating team. Please try again."});return}window.location.href="/"};return e.jsxs("div",{className:"flex flex-col min-h-screen bg-black text-white",children:[e.jsx(y,{userName:f}),e.jsx("main",{className:"flex-grow flex flex-col justify-center items-center px-4 md:px-6",children:e.jsxs("div",{className:"w-full max-w-md space-y-6 bg-[#1a1a1a] p-8 rounded-lg shadow-lg",children:[e.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-center",children:"Create Team"}),e.jsxs("form",{onSubmit:g,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-300",children:["Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(u,{type:"text",id:"name",name:"name",required:!0,placeholder:"Enter team name",className:"bg-[#2a2a2a] text-white border border-gray-600 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"contactNumber",className:"block text-sm font-medium text-gray-300",children:["Contact Number"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(u,{type:"text",pattern:"[0-9]{10}",id:"contactNumber",name:"contactNumber",required:!0,placeholder:"Enter contact number",className:"bg-[#2a2a2a] text-white border border-gray-600 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs(b,{type:"submit",className:"w-full bg-white hover:bg-gray-200 text-black font-bold py-3 rounded-lg flex items-center justify-center gap-2",children:[e.jsx("span",{children:"Create Team"}),e.jsx(N,{className:"h-5 w-5"})]})]})]})})]})};export{T as default};
